@if (isDev) {
  <div class="debug-fab-container">
    @if (isOpen()) {
      <button
        type="button"
        (click)="close()"
        class="fixed inset-0 z-40 cursor-default bg-black/20"
        aria-label="Cerrar panel debug"
      ></button>
    }
    <div class="debug-fab-wrapper">
      @if (isOpen()) {
        <div
          class="debug-panel rounded-2xl bg-white border-2 border-amber-200 shadow-xl p-4 z-50"
          (click)="$event.stopPropagation()"
          role="dialog"
          aria-label="Modo Dios - Cambiar estado de obra"
        >
          <h3 class="text-xs font-black text-amber-700 uppercase tracking-wider mb-3">Modo Dios</h3>
          @if (worksForDebug().length === 0) {
            <p class="text-sm text-slate-500">Carga obras (Home o Admin) para probar.</p>
          } @else {
            <label class="block text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-1.5">Obra</label>
            <select
              [value]="selectedWorkId() ?? ''"
              (change)="selectWork($any($event.target).value)"
              class="w-full text-sm font-medium text-slate-700 bg-slate-50 border border-slate-200 rounded-xl py-2 px-3 mb-3"
            >
              @for (w of worksForDebug(); track w.id) {
                <option [value]="w.id">{{ workLabel(w) }} ({{ w.status }})</option>
              }
            </select>
            @if (selectedWork()) {
              <p class="text-[10px] text-slate-400 mb-2">Estado actual: <strong>{{ selectedWork()!.status }}</strong></p>
            }
            <label class="block text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-1.5">Saltar a</label>
            <div class="flex flex-wrap gap-2">
              @for (status of statusOptions; track status) {
                <button
                  type="button"
                  (click)="setStatus(status)"
                  [class]="getButtonClass(status)"
                >
                  {{ getStatusLabel(status) }}
                </button>
              }
            </div>
          }
        </div>
      }
      <button
        type="button"
        (click)="toggle()"
        class="debug-fab rounded-full shadow-lg border-2 border-amber-300 bg-amber-400 hover:bg-amber-500 text-amber-900 font-black text-sm flex items-center justify-center transition-colors"
        aria-label="Abrir panel debug (Modo Dios)"
        [attr.aria-expanded]="isOpen()"
      >
        âš¡
      </button>
    </div>
  </div>
}

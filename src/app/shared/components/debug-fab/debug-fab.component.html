@if (!isProduction) {
  <div class="debug-fab-container">
    @if (isOpen()) {
      <button
        type="button"
        (click)="close()"
        class="fixed inset-0 z-40 cursor-default bg-black/20"
        aria-label="Cerrar menú debug"
      ></button>
    }
    <div class="debug-fab-wrapper">
      @if (isOpen()) {
        <div
          class="debug-menu rounded-2xl bg-white border border-slate-200 shadow-xl p-4 z-50 mb-2"
          (click)="$event.stopPropagation()"
          role="dialog"
          aria-label="Menú Modo Dios - Salto de estado"
        >
          <h3 class="text-xs font-black text-slate-500 uppercase tracking-wider mb-3">Salto de Estado</h3>
          @if (worksForDebug().length === 0) {
            <p class="text-sm text-slate-500">Carga obras (Home o Admin) para probar.</p>
          } @else {
            <label class="block text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-1.5">Obra actual</label>
            <select
              [value]="selectedWorkId() ?? ''"
              (change)="selectWork($any($event.target).value)"
              class="w-full text-sm font-medium text-slate-700 bg-slate-50 border border-slate-200 rounded-xl py-2 px-3 mb-4"
            >
              @for (w of worksForDebug(); track w.id) {
                <option [value]="w.id">{{ workLabel(w) }} ({{ w.status }})</option>
              }
            </select>
            <div class="flex flex-col gap-2">
              <button type="button" (click)="approveCredit()" class="w-full px-4 py-2.5 rounded-xl text-sm font-bold text-white bg-emerald-600 hover:bg-emerald-700 transition-colors text-left">
                Aprobar Crédito
              </button>
              <button type="button" (click)="sendToPartners()" class="w-full px-4 py-2.5 rounded-xl text-sm font-bold text-white bg-amber-500 hover:bg-amber-600 transition-colors text-left">
                Enviar a Partners
              </button>
              <button type="button" (click)="simulatePartnersOk()" class="w-full px-4 py-2.5 rounded-xl text-sm font-bold text-white bg-blue-600 hover:bg-blue-700 transition-colors text-left">
                Simular Respuestas OK
              </button>
              <button type="button" (click)="startWork()" class="w-full px-4 py-2.5 rounded-xl text-sm font-bold text-white bg-slate-600 hover:bg-slate-700 transition-colors text-left">
                Iniciar Obra
              </button>
              <button type="button" (click)="clearAll()" class="w-full px-4 py-2.5 rounded-xl text-sm font-bold text-white bg-rose-600 hover:bg-rose-700 transition-colors text-left mt-2">
                Limpiar Todo
              </button>
            </div>
          }
        </div>
      }
      <button
        type="button"
        (click)="toggle()"
        class="debug-fab rounded-full shadow-lg flex items-center justify-center transition-colors text-white bg-slate-800 hover:bg-slate-700"
        aria-label="Abrir menú debug (Modo Dios)"
        [attr.aria-expanded]="isOpen()"
      >
        <span class="text-xl" aria-hidden="true">⚙️</span>
      </button>
    </div>
  </div>
}
